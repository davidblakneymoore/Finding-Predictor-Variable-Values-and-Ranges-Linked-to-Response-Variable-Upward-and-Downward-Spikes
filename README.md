# Finding-Predictor-Variable-Values-and-Ranges-Linked-to-Response-Variable-Upward-and-Downward-Spikes

The function here (`Determining_Predictor_Variable_Values_and_Ranges_of_Values_Corresponding_to_Upward_and_Downward_Spikes_in_Response_Variable_Values`) is used to identify specific predictor-variables values and ranges of predictor-variable values that correspond to positive and negative spikes in response-variable values.

For example, [here](https://raw.githubusercontent.com/davidblakneymoore/Finding-Predictor-Variable-Values-and-Ranges-Linked-to-Response-Variable-Upward-and-Downward-Spikes/refs/heads/main/Sugar%20Maple%20Wood%20Temperature%20and%20Sap%20Flow%20Figure.jpeg) is a figure depicting the relationship between wood temperature (the predictor variable) and sap flow (the response variable). These data come from February of 2023 from a sugar maple (*Acer saccharum*) during winter dormancy located in Durham, New Hampshire, and are from breast height at a sapwood depth of 1 cm beneath the bark. It's evident that a substantial amount of sap flow occurs near the freezing point of water (0 Ëš C), but can the precise value at which sap flow is maximized in both the upward (positive) and downward (negative) directions be determined mathematically? Furthermore, can ranges of wood temperatures be extracted from this plot that correspond to significant sap flows in both directions?

To determine the critical wood temperature values - the wood temperature values associated with maximal positive and negative sap flows - we use an iterative, least-squares approach. [This figure](https://raw.githubusercontent.com/davidblakneymoore/Finding-Predictor-Variable-Values-and-Ranges-Linked-to-Response-Variable-Upward-and-Downward-Spikes/refs/heads/main/Finding%20Specific%20Predictor-Variable%20Values%20Associated%20With%20Positive%20and%20Negative%20Spikes%20in%20Response-Variable%20Values.jpeg) depicts the method. First, the data are split by positive and negative response-variable values. Next, a sequence of equally spaced horizontal-axis values are generated from the minimum to the maximum predictor-variable value (more values are better). Then, a sequence of angles are generated between `0` and `2 / pi` rad (again, more values are better). These angles correspond to the two solid black lines in the example figure for this method. For each combination of horizontal-axis value and angle, data are filtered to include either only points falling between these two lines (these points are red in the example figure) or points falling outside of these two lines (these points are green in the figure). Although the example figure depicts both the predictor variable and the response variable in their original units, this algorithm converts both variables to z scores (separately) internally to ensure that they are both standardized and thus on the same scale. Next, the sum of squared residuals is calculated for both red and green points separately - the horizontal distance between the red points and the bold, dashed, vertical red line are calculated, squared, and summed, and similarly, the vertical distance between the green points and the bold, dashed, horizontal green line are calculated, squared, and summed. These two sums of squares are themselves summed, and this overall sum of squares represents the overall ability of the particular combination of horizontal-axis coordinate and angle to describe the system. After this process is carried out for each combination of horizontal-axis coordinate and angle, the combination with the least sum of squares is chosen, and the 'critical value' is deemed to be the hortizontal-axis variable associated with this combination.

To determine ranges of wood temperatures associated with significant sap flows, we first discretize wood temperatures by grouping them into bins of equal width. [This figure](https://raw.githubusercontent.com/davidblakneymoore/Finding-Predictor-Variable-Values-and-Ranges-Linked-to-Response-Variable-Upward-and-Downward-Spikes/refs/heads/main/Finding%20Ranges%20of%20Predictor-Variable%20Values%20Associated%20With%20Positive%20and%20Negative%20Spikes%20in%20Response-Variable%20Values.jpeg) depicts this method; again, this method is performed on both positive and negative response-variables separately to account for the possibility that different mechanisms drive positive and negative response-variable values. These bins are delineated by the vertical red lines in this example figure under the 'Step 1' heading. Next, for each bin separately, the 95<sup>th</sup> percentile
